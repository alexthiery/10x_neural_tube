#!/usr/bin/env nextflow

nextflow.enable.dsl=2

/*-----------------------------------------------------------------------------------------------------------------------------
Pipeline params
-------------------------------------------------------------------------------------------------------------------------------*/
params.rFile = "$baseDir/../bin/R/seurat_full_slim.R"
params.customFuncs = "$baseDir/../bin/R/custom_functions"
params.networkGenes = "$baseDir/../input_files/network_expression.csv"

/*-----------------------------------------------------------------------------------------------------------------------------
Include modules
-------------------------------------------------------------------------------------------------------------------------------*/

include {runR} from "$baseDir/../modules/runR/runR.nf"

/*------------------------------------------------------------------------------------
Define input channels
--------------------------------------------------------------------------------------*/
Channel
    .fromPath( params.input )
    .collect()
    .set { ch_cellrangercounts }

/*-----------------------------------------------------------------------------------------------------------------------------
Main workflow
-------------------------------------------------------------------------------------------------------------------------------*/
workflow {
    runR( file(params.rFile), ch_cellrangercounts )
}
